<router-outlet></router-outlet>

<!-- card logout -->
<div class="card login">
  <img class="profilePhoto" src="{{this.user.photo}}" *ngIf="user!=null" (click)="goToMyProfile();">
  <label class="welcome-label" *ngIf="user!=null">Welcome, {{ user.firstName }}!</label>
  <h1 class="headline">UCL Bay</h1>
  <button class="button" routerLink="/register" *ngIf="user==null">
    <span>Register</span>
  </button>
  <button class="button" routerLink="/login" *ngIf="user==null">
    <span>Login</span>
  </button>
  <button class="button" (click)="logout()" *ngIf="user!=null">
    <span>Logout</span>
  </button>
  <button class="button" (click)="goBack()" *ngIf="user!=null">
    <span>Go Back</span>
  </button>
</div>

<br>
<br>
<br>
<br>

<!-- item details -->
<section class="card item-details">
  <h1 class="item-name">{{ item?.name }}</h1>
  <br>
  <!-- info -->
  <div class="info">
    <div class="info-columns">
      <div class="left-items">

        <div>

          <div class="slideshow-container">

            <div class="mySlides fade">
              <!-- <div class="numbertext" *ngIf="(item?.photo2 != null && item?.photo3 == null) || (item?.photo3 != null && item?.photo2 == null)">1 / 2</div>
         <div class="numbertext" *ngIf="item?.photo2 != null && item?.photo3 != null">1 / 3</div>-->
              <img class="item-photo" src="{{ item?.photo1 }}" alt="{{ item?.itemID }}">
            </div>

            <div class="mySlides fade">
              <div *ngIf=" item?.photo2 != null">
                <!--  <div class="numbertext" *ngIf="item?.photo2 != null && item?.photo3 == null">2 / 2</div>
        <div class="numbertext" *ngIf="item?.photo2 != null  && item?.photo3 != null">2 / 3</div>-->
                <img class="item-photo" src="{{item?.photo2}}" *ngIf="item?.photo2 != null">
              </div>
            </div>

            <div class="mySlides fade">
              <div *ngIf=" item?.photo3 != null">
                <!-- <div class="numbertext" *ngIf="item?.photo2 != null && item?.photo3 != null">3 / 3</div>
        <div class="numbertext" *ngIf="item?.photo3 != null && item?.photo2 == null">2 / 2</div>-->

          <img class="item-photo" src="{{item?.photo3}}" *ngIf="item?.photo3 != null"> 
        </div>
      </div>

      </div>
      <br>

      <div style="text-align:center" *ngIf="item?.photo2 != null || item?.photo3 != null">
        <span class="dot" (click)="currentSlide(1)"></span> 
        <span class="dot" (click)="currentSlide(2)" ></span> 
        <span class="dot" (click)="currentSlide(3)"></span> 
      </div>
   
    </div>


        <h3 class="item-description">{{ item?.description }}</h3>
        <br>
        <br>
        <div class="item-left userinfo-box">
          <div class="vertical-align">
            <h3 id="sellerInfo" class="sellerInfo">Seller: </h3>
            <h3 id="sellerName" class="sellerName link" [routerLink]="['/profile', seller?.userID]">{{ seller?.username }}</h3>

            <div class="star" title="{{ seller?.username }}'s average rating">
              <div class="rating" [style.width.%]="sellerRating">
                <span>&#x2605; &#x2605; &#x2605; &#x2605; &#x2605;</span>
              </div>
            </div>
            <h6 class="ratingcount" *ngIf="sellerFeedbackCount > 1">({{ sellerFeedbackCount }} people have rated {{ seller?.username }})</h6>
            <h6 class="ratingcount" *ngIf="sellerFeedbackCount == 1">({{ sellerFeedbackCount }} person has rated {{ seller?.username }})</h6>
            <h6 class="ratingcount" *ngIf="sellerFeedbackCount == 0">({{ seller?.username }} is yet unrated)</h6>
          </div>
        </div>
      </div>

      <div class="right-items">
        <h3 class="item-right" *ngIf=" item.quantity > 1 ">Quantity: {{ item?.quantity }}</h3>
        <br *ngIf="item.quantity > 1">
        <br *ngIf="item.quantity > 1">

        <h3 class="item-right" *ngIf="highestBid != null">Current bid: £{{ highestBid }} </h3>
        <br *ngIf="highestBid != null">
        <br *ngIf="highestBid != null">

        <h3 class="item-right" *ngIf="auction != null && highestBid == null">Start price: £{{ auction.startPrice }}</h3>
        <br *ngIf="auction != null && highestBid == null">
        <br *ngIf="auction != null && highestBid == null">

        <h3 class="item-right" *ngIf="buyItNowPrice != null && (buyItNowPrice > highestBid || highestBid == null)">Buy it now price: £{{ buyItNowPrice }} </h3>
        <br *ngIf="buyItNowPrice != null && (highestBid == null || buyItNowPrice > highestBid)">
        <br *ngIf="buyItNowPrice != null && (highestBid == null || buyItNowPrice > highestBid)">

     

        <h3 class="item-right" *ngIf="distinctViewers != null">Total bids: {{ numberBids }}</h3>
        <br *ngIf="distinctViewers != null">
        <br *ngIf="distinctViewers != null">

        <h3 class="item-right">Condition: {{item?.condition}}</h3>
        <br>
        <br>

        <h3 class="item-right" *ngIf="distinctViewers != null">Total viewings: {{ distinctViewers }}</h3>
        <br *ngIf="distinctViewers != null">
        <br *ngIf="distinctViewers != null">

        <h3 class="item-right" *ngIf="distinctViewers != null">Buyers watching: {{ watchers }}</h3>
        <br *ngIf="distinctViewers != null">
        <br *ngIf="distinctViewers != null">

        <h3 class="item-right" id="countdown" *ngIf="auction != null"></h3>

        <br *ngIf="isExpired &&  highestBidderID != null">
        <br *ngIf="isExpired &&  highestBidderID != null">

        <h3 class="item-right link" id="auction-winner" *ngIf="isExpired &&  highestBidderID != null" [routerLink]="['/profile', highestBidderID]">
          {{ highestBidder?.username }}</h3>
        <h3 class="item-right" id="auction-winner" *ngIf="isExpired &&  highestBidderID != null">Winner:&nbsp;</h3>

      </div>

    </div>

    <app-feedback [user]="user" [buyerID]="highestBidderID" [subject]="highestBidder?.username" [sellerID]="item.sellerID" [item]="item"
      *ngIf="isExpired && highestBidderID != null && sellerFeedbackGiven == false && item.sellerID === user.userID"></app-feedback>

    <app-feedback [user]="user" [buyerID]="highestBidderID" [subject]="seller?.username" [sellerID]="item.sellerID" [item]="item"
      *ngIf="isExpired && buyerFeedbackGiven == false && highestBidderID === user.userID"></app-feedback>
    <br>
    <br>

    <form *ngIf="user != null && item.sellerID != user.userID && isExpired == false" id="bid-form">
      <div class="bid-box">
        <input type="number" [(ngModel)]="newBid" name="newBid" id="newBid" placeholder="Enter bid amount (£)">
        <input type="submit" value="Bid" id="submit-bid" (click)="bid()">
      </div>
      <br>
      <div class="bid-box">
      <input type="submit" value="Buy It Now" (click)="buyItNow()" id="buy-now-btn" *ngIf="buyItNowPrice != null && (buyItNowPrice > highestBid || highestBid == null)">
      <input type="submit" value="Watch Auction" (click)="watchAuction()" id="watch-btn" *ngIf="isWatching === false && isOutbid == false && highestBidderID != user.userID">
      <input type="submit" value="Remove from watch list" (click)="stopWatching()" *ngIf="isWatching === true && highestBidderID != user.userID && isOutbid === false">
      </div>
    </form>
    <br>
  </div>

</section>

